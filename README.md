# Финальный проект курса в учебном центре "Отус" 
# "Machine learning. Advanced"

1. Главная идея проекта - показать асимметричную функцию потерь AsymmetricLoss (FocalLoss)
2. Использовались анонимизированные данные о транзакциях клиентов банка

## Описание задачи
Задача оценки вероятности пролонгации депозитных сделок клиентов банка.
Описание:
Один из основных инструментов сбережения денежных средств является срочный банковский депозит.
По истечении срока, клиент может как забрать депозит, так и пролонгировать его,
открыв новую депозитную сделку.
Банку для управления портфелем средств клиентов важно понимать, с какой вероятностью клиент
оставит свои средства на новом депозите.
Вероятность пролонгации может зависеть от текущих условий сделок,
от изменения текущих условий сделки относительно предыдущих условий сделок этого клиента,
от характеристик самого клиента,
от поведения клиента по открытию депозитных сделок в прошлом,
а также от макроэкономической ситуации в момент заключения сделки.
Для банка рискованнее ошибочно считать, что пролонгация произойдет,
т.к. привлечь недостающие средства дороже, чем разместить избыточные.
Задача:
	Построить модель вероятности пролонгации депозитной сделки.

Описание данных:
В данных приводятся ID сделок и клиентов,
даты заключения и истечения срока действия депозита,
срок депозита, прочие условия депозитного договора,
характеристики и типы  клиентов.

Также можно предложить и добавить к данным характеристики макроэкономических условий
из открытых источников (Росстат, ЦБ РФ и прочие статистические ресурсы).
________________________  
Использовалась модель Catboost
________________________
 Функцию потерь (LossObjective) и целевую  метрику (EvalMetric, CustomMetric) можно добавить в виде встроенной (native) или внешней функции.
 
 Чтобы добавить встроенную фунцию, на С++, надо написать соответствующий класс,  и перекомпилировать исходники репозитория catboost, вместе с написанным классом. Это долгий трудоемкий процесс, годится тогда, когда мы уже решили, что функция "заходит", т.е. нам нравится, как она работает на наших данных 
 
 Однако экспериментировать с разными функциями потерь и метриками, найденными на arxiv, выписывая на С++ класс для каждого эксперимента, и перекомпилируя библиотеку - не самая лучшая затея.
 
 Я попробовал в этой работе использовать механизм внешних функций. 
 
 Ход эксперимента:
 
 1. baseline - на наших данных применить встроенную оптимизированную LogLoss. 
 2. Реализовать свои функции logloss на Python, сравнить быстродействие. (в файле custom_metrics.py, LoglossObjective_np и LoglossObjective_loop) 
 3. Реализовать свою logloss на Cython, также рсавнить быстродействие
 4. Реализовать внешнюю FocalLoss и её обобщение AsymmetricLoss, для сравнения качества прогноза с эталонной штатной LogLoss. Идея взята [здесь](https://arxiv.org/pdf/2009.14119.pdf) 
   
 
  
 Catboost, однако, на конец февраля
   
на конец февраля в catboost было невозможно добавить внешнюю